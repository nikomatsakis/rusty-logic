%Version 3 October 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove �Numbered� in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst%  
 
%%\documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
\documentclass[sn-mathphys-num]{sn-jnl}% Math and Physical Sciences Numbered Reference Style 
%%\documentclass[sn-mathphys-ay]{sn-jnl}% Math and Physical Sciences Author Year Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style

%%%% Standard Packages
%%<additional latex packages if required can be included here>

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%

% additions:

%% for inferences rules
%% https://www.khoury.northeastern.edu/home/wand/csg264/latex/mathpartir/mathpartir.pdf
\usepackage{mathpartir}%
%%%%

\lstdefinelanguage{Rust}{
    keywords={fn, trait, type, impl, for, where},
    mathescape = true,
}

\newcommand{\code}[1]{{\tt #1}}

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Rust for Logicians]{Rust for Logicians}

%%=============================================================%%
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% \author*[1,2]{\fnm{Joergen W.} \spfx{van der} \sur{Ploeg} 
%%  \sfx{IV}}\email{iauthor@gmail.com}
%%=============================================================%%

\author{\fnm{Nicholas} D. \sur{Matsakis}}\email{rust@nikomatsakis.com}

%%==================================%%
%% Sample for unstructured abstract %%
%%==================================%%

\abstract{
    ABSTRACT
}

\keywords{Keyword1 Keyword2}

\maketitle

\section{Introduction}\label{sec1}

Introduction

\section{Notation}

We use an overline $\overline{S}$ to indicate zero or more instances of the symbol $S$.
Syntactically it is represented as a comma-separated list (with optional trailing comma).

We reference the following terminals (also called tokens):

\begin{itemize}
    \item a struct name $S$
    \item a trait name $T$
    \item an associated type name $A$
    \item a type parameter $X$
\end{itemize}

In the sections that follow we define the following non-terminals:

\begin{itemize}
    \item A type name $\tau$
    \item A trait definition and Implementations
    \item A where clause $W$
\end{itemize}

\subsection{Types}

A type $\tau$ is...

\begin{itemize}
    \item a struct $S\langle\overline{\tau}\rangle$ with type parameters $\overline{\tau}$
    \item an associated type $A\:\tau$
    \item a type parameter $X$
\end{itemize}

\subsection{Trait definitions and impls in Rust}

In Rust, a \emph{trait} $T$ is an interface, declared like so:

\begin{lstlisting}[language=Rust]
trait $T$: $\overline{T_s}$ {
    type $A$: $\overline{T_b}$;
}
\end{lstlisting}

Traits in Rust contain methods and other kinds of members, but we limit ourselves to the case of exactly one associated type.
The trait definition includes:

\begin{itemize}
    \item The trait name $T$
    \item A list of ``supertraits'' $\overline{T_s}$. Every type that implements $T$ must also implement $\overline{T_s}$.
    \item An associated type $A$. Every impl of $T$ must prove a value $\tau_A$ for $A$.
    \item A list of bounds $\overline{T_b}$ on $A$. The value $\tau_A$ provided for $A$ must satisfy the bounds $\overline{T_b}$.
\end{itemize}

Traits are \emph{implemented} for a given type $\tau$ via a \code{impl}:

\begin{lstlisting}[language=Rust, mathescape=true]
impl<$\overline{X}$> $T$ for $\tau$ where $\overline{W}$ {
    type $A$ = $\tau_A$;
}
\end{lstlisting}

Implementations in Rust include:

\begin{itemize}
    \item A set of type parameters 
\end{itemize}
    
\subsection{Where Clauses}

A provable predicate in our system is a \emph{where clause} $W$:

\begin{itemize}
    \item \code{t: T} indicates that $\tau$ implements the trait $T$.
    \item \code{t: T<A = t1>} indicates that $\tau$ implements the trait $T$ and that the associated type $A$ is equal to $\tau_1$.
    \item \code{for<X...> W} indicates that $W$ is provable for all values of $overline{X}$.
    \item \code{W0 => W1}, not available in Rust today, indicates that $W_0$ being true implies $W_1$ holds.
\end{itemize}


Rust where clauses correspond to logical
Rust's syntax can be translated into our mathematical where-clauses as follows:

\begin{itemize}
    \item \code{t: T} becomes $T\:\tau$
    \item \code{t: T<A = t1>} becomes $T\:\tau, A\:\tau \mapsto \tau_1$
    \item \code{for<X..> W} becomes $\forall\overline{X}. [\![ W ]\!]$
    \item \code{W0 => W1}, not available in Rust today, becomes $[\![ W_0 ]\!] \Rightarrow [\![ W_1 ]\!]$.
\end{itemize}

\section{Judgments}

\begin{itemize}
    \item $\Gamma \vdash T \: \tau$ (the trait $T$ is implemented for $\tau$)
    \item $\Gamma \vdash A \: \tau \mapsto \tau_1$ (the associated type $A$, applied to the type $\tau$ reduces to $\tau_1$)
\end{itemize}

\section{Basic axioms}

\begin{mathpar}
    \inferrule[Assumption]{
        W \in \Gamma
    }{
        \Gamma \vdash W
    }

    \inferrule[Implication]{
        \Gamma,W_0 \vdash W_1
    }{
        \Gamma \vdash (W_0 \Rightarrow W_1)
    }

    \inferrule[Forall]{
        \Gamma \vdash W \\
        X \notin FV(\Gamma, W)
    }{
        \Gamma \vdash \forall \overline{X}.W
    }
    
    \inferrule[Exists]{
        \Gamma \vdash [\overline{\tau}/\overline{X}] W
    }{
        \Gamma \vdash \exists{\overline{X}}.W
    }

    \inferrule[And]{
        \Gamma \vdash W_0 \\
        \Gamma \vdash W_1
    }{
        \Gamma \vdash W_0 \wedge W_1
    }
    
    \inferrule[Or]{
        \Gamma \vdash W_i
    }{
        \Gamma \vdash W_0 \vee W_1
    }
\end{mathpar}

% ## Trait definitions

% A Rust trait definition...

% ```rust
% ```

% ...can be translated to the following inference rules based on sequents...

% * $\Gamma \vdash T_{s_i} \: \tau$ holds if...
%     * $\Gamma \vdash T\:\tau$
% * $\Gamma \vdash T_{b_i} \: (A\:\tau)$ holds if...
%     * $\Gamma \vdash T\:\tau$

% ## Trait impls

% A Rust trait impl...

% ```rust
% impl<X_0..X_n> T for t
% where
%     W_0..W_n,
% {
%     type A = t_1;
% }
% ```

% ...can be translated to the following inference rules based on sequents...

% * $\Gamma \vdash T_{s_i} \: \tau$ holds if...
%     * $\Gamma \vdash T\:\tau$
% * $\Gamma \vdash T_{b_i} \: (A\:\tau)$ holds if...

% ## Trait impls

% A Rust trait impl...

\section{Conclusion}\label{sec13}

Conclusions may be used to restate your hypothesis or research question, restate your major findings, explain the relevance and the added value of your work, highlight any limitations of your study, describe future directions for research and recommendations. 

In some disciplines use of Discussion or 'Conclusion' is interchangeable. It is not mandatory to use both. Please refer to Journal-level guidance for any specific requirements. 

\backmatter

\bmhead{Acknowledgements}

Acknowledgements are not compulsory. Where included they should be brief. Grant or contribution numbers may be acknowledged.

Please refer to Journal-level guidance for any specific requirements.

\begin{appendices}

\section{Section title of first appendix}\label{secA1}

An appendix contains supplementary information that is not an essential part of the text itself but which may be helpful in providing a more comprehensive understanding of the research problem or it is information that is too cumbersome to be included in the body of the paper.

%%=============================================%%
%% For submissions to Nature Portfolio Journals %%
%% please use the heading ``Extended Data''.   %%
%%=============================================%%

%%=============================================================%%
%% Sample for another appendix section			       %%
%%=============================================================%%

%% \section{Example of another appendix section}\label{secA2}%
%% Appendices may be used for helpful, supporting or essential material that would otherwise 
%% clutter, break up or be distracting to the text. Appendices can consist of sections, figures, 
%% tables and equations etc.

\end{appendices}

%%===========================================================================================%%
%% If you are submitting to one of the Nature Portfolio journals, using the eJP submission   %%
%% system, please include the references within the manuscript file itself. You may do this  %%
%% by copying the reference list from your .bbl file, paste it into the main manuscript .tex %%
%% file, and delete the associated \verb+\bibliography+ commands.                            %%
%%===========================================================================================%%

\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl


\end{document}
